# Local envs check

## Context
- Локальные приложения Creatio разворачиваются командой `deploy-creatio`, что регистрирует env в конфигурации clio.
- На macOS поднимается служба, которая автозапускает сервис.
- Папки приложений могут быть удалены вручную, но записи env и службы остаются — нужно выявлять “висячие” env.

## Команда
- `clio show-local-envs`
	- Выводит список локальных env (у которых указан путь к env).
	- Колонки: Name | Status | Url | Path | Reason.
	- Формат: стилизованная таблица с цветными элементами для статусов.

## Источник данных
- Использовать существующую абстракцию настроек (в ней уже есть все сведения об env).
- Не читать файл конфигурации clio напрямую.

## Проверки и статусы
- OK: успешный ping и успешный login.
- Error Auth data: ping успешен, login неуспешен.
- Deleted: путь отсутствует или в каталоге нет ничего, кроме `Logs`.
- Not runned: ping неуспешен, но каталог есть и в нем есть что-то помимо `Logs`.

## Причины (Reason)
- Deleted: "directory not found" или "directory is empty except Logs".
- Not runned: "ping failed" (дополнительно указать ошибку, если есть).
- Error Auth data: "login failed" (добавить текст ошибки/кода, если доступно).
- OK: "healthy".

## Дополнительные правила
- Фильтра по ОС не требуется.
- Пустой список env: вывод информативного сообщения (таблица без строк или строка "no local envs found").
- Если нет доступа к каталогу: трактовать как Deleted с reason "access denied".

## План имплементации
1) Получить список локальных env через абстракцию настроек (имя, URL, путь).
2) Для каждого env: проверить путь через файловую абстракцию (существует ли и есть ли содержимое помимо `Logs`).
3) Выполнить ping существующим clio-сервисом/командой; при успехе — выполнить login тем же слоем.
4) Назначить статус по матрице выше и сформировать reason.
5) Отрендерить таблицу со статусами (цвета по статусу) и выводом Name/Status/Url/Path/Reason; если список пуст — вывести сообщение.
6) Добавить модульные тесты: матрица статусов (OK, Error Auth, Deleted, Not runned), пустой список env, недоступный каталог.