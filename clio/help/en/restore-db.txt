COMMAND TYPE
    Database commands

NAME
    restore-db (rdb) - Restores database from backup file to either Kubernetes 
                       cluster or local database server

DESCRIPTION
    restore-db command restores a database from a backup file to a database 
    server. It supports both PostgreSQL and MSSQL databases.
    
    The command can restore to:
    - Kubernetes cluster (default behavior)
    - Local database server (when --dbServerName is specified)
    
    When restoring to a local server, the command:
    - Tests connection before restore (fail-fast)
    - Auto-detects backup file type (.backup for PostgreSQL, .bak for MSSQL)
    - Validates backup type matches database type
    - Automatically drops existing database if present
    - For PostgreSQL: uses pg_restore tool (must be installed)

PREREQUISITES
    For PostgreSQL local restore, PostgreSQL client tools must be installed:
    
    Windows: Download from https://www.postgresql.org/download/windows/
    Linux:   Install via package manager (e.g., apt-get install postgresql-client)
    macOS:   Install via Homebrew (brew install postgresql)

CONFIGURATION
    To restore to a local database server, add a 'db' section to appsettings.json:
    
    {
      "db": {
        "my-local-mssql": {
          "dbType": "mssql",
          "hostname": "localhost",
          "port": 1433,
          "username": "sa",
          "password": "YourPassword",
          "description": "Local MSSQL Server for development"
        },
        "my-local-postgres": {
          "dbType": "postgres",
          "hostname": "localhost",
          "port": 5432,
          "username": "postgres",
          "password": "postgres",
          "pgToolsPath": "",
          "description": "Local PostgreSQL Server for development"
        }
      }
    }
    
    Configuration fields:
    - dbType (required): Database type - 'mssql' or 'postgres'
    - hostname (required): Database server hostname or IP address
    - port (required): Database server port (1433 for MSSQL, 5432 for PostgreSQL)
    - username (required): Database username
    - password (required): Database password
    - description (optional): Description for documentation
    - pgToolsPath (optional, PostgreSQL only): Path to PostgreSQL client tools 
                                                directory if not in PATH

SYNOPSIS
    clio restore-db [OPTIONS]

OPTIONS
    --dbName               Database name to create/restore (required)
    
    --backupPath          Path to backup file or ZIP archive (required when using --dbServerName)
                          - .zip file containing db/*.bak or db/*.backup
                          - .backup extension for PostgreSQL backups
                          - .bak extension for MSSQL backups
    
    --dbServerName        Name of database server configuration from appsettings.json
                          (optional)
                          - If specified: restores to configured local server
                          - If not specified: uses Kubernetes/environment behavior

EXAMPLE
    Restore from ZIP file (Creatio installation package):
    clio restore-db --dbServerName my-local-mssql --dbName creatiodev 
                    --backupPath C:\Creatio\8.3.3.1343_Studio_MSSQL_ENU.zip
    Restore to Kubernetes cluster (existing behavior):
    clio restore-db --dbName mydb --backupPath /path/to/backup.backup

    Restore to local PostgreSQL server:
    clio restore-db --dbServerName my-local-postgres --dbName creatiodev 
                    --backupPath database.backup

    Restore to local MSSQL server:
    clio restore-db --dbServerName my-local-mssql --dbName creatiodev 
                    --backupPath database.bak

    Restore PostgreSQL with explicit tools path:
    Configure pgToolsPath in appsettings.json:
    {
      "db": {
        "custom-postgres": {
          "dbType": "postgres",
          "hostname": "localhost",
          "port": 5432,
          "username": "postgres",
          "password": "postgres",
          "pgToolsPath": "C:\\Program Files\\PostgreSQL\\16\\bin"
        }
      }
    }
    
    clio restore-db --dbServerName custom-postgres --dbName creatiodev 
                    --backupPath database.backup

FEATURES
    - Connection Testing: Tests database connectivity before attempting restore
    - Automatic Type Detection: Determines backup type from file extension
    - Type Validation: Ensures backup file type matches database server type
    - Existing Database Handling: Automatically drops existing database before restore
    - PostgreSQL Tools Detection: Automatically finds pg_restore in PATH or 
                                  common installation locations
    - Comprehensive Error Messages: Provides detailed error messages with 
                                    actionable suggestions

ERROR HANDLING
    The command provides detailed error messages for common issues:
    
    Configuration not found:
        Lists available configurations in appsettings.json
    
    Connection failures:
        Suggests checking server status, credentials, and firewall settings
    
    Missing pg_restore:
        Provides download link and installation instructions
    
    Incompatible backup type:
        Explains the mismatch between backup and database types

TROUBLESHOOTING
    PostgreSQL: "pg_restore not found"
    - Install PostgreSQL client tools
    - Add PostgreSQL bin directory to PATH environment variable
    - Or specify pgToolsPath in configuration
    
    Connection test failed
    - Verify database server is running
    - Check hostname and port are correct
    - Verify username and password
    - Check firewall settings
    
    Backup type mismatch
    - Ensure .backup files are used with PostgreSQL servers
    - Ensure .bak files are used with MSSQL servers

REPORTING BUGS
    https://github.com/Advance-Technologies-Foundation/clio
